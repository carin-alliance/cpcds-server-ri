Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database <init>
INFO: JDBC: jdbc:h2:./target/database/oauth;DB_CLOSE_DELAY=-1
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database <init>
INFO: BEGIN TRANSACTION;

    CREATE TABLE IF NOT EXISTS Users (
        "username" varchar PRIMARY KEY,
        "patient_id" varchar NOT NULL,
        "password" varchar NOT NULL,
        "refresh_token" varchar DEFAULT NULL,
        "timestamp" datetime DEFAULT CURRENT_TIMESTAMP
    );

    CREATE TABLE IF NOT EXISTS Clients (
        "id" varchar PRIMARY KEY,
        "secret" varchar NOT NULL,
        "redirect" varchar NOT NULL,
        "timestamp" datetime DEFAULT CURRENT_TIMESTAMP
    );

COMMIT;
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Clients(1339730998)
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Clients(1064648458)
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User Patient1(Patient1): password($2a$10$i3VHJx/uHZ5dhIS7IWPUhelBX998DjFRzzVO/YU7/40vy/ExqBPUK))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User PatientEx1(PatientEx1): password($2a$10$UsNN1vMBYXY4szUoEXrBcO/Q0qMPc/rEj.Y4Pp8S2tkH3yB6rpa8i))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User admin(admin): password($2a$10$eKR5eBa5dU6CyQ/oVO2jm.mTVfc8IPR1CPyHez7ez5g40d3cKes5e))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User Patient2(026f2676-d635-47b9-af1e-95de31cda9b1): password($2a$10$AzjMiwOaBVLje6yTYMPu7OhDgo5UbVDb/6HwsNZixXqum5rszf2WO))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User Patient3(14c20e78-610b-405b-aad1-9c8f6109152c): password($2a$10$5fH3YxEqG8zPRB2jSc63Du85KJ4L2oVCI9HzErX8AtNJ/dW0Q8XJi))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User Patient4(6da541e2-62f4-42a7-8009-23e2d97116df): password($2a$10$CMgJ.5ySqFPc0IckvxOqx.AVi7YvFIlUwjqbdmiQEktFwnVOsvxli))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.Database write
INFO: Database::write Users(User Patient5(ec19f75c-c674-478c-8916-8acb2f1b0a68): password($2a$10$Ni/e5vzUz9/Tw8f2CD4Zc.TEuOrAq6WGM.Iu6Iwg9ly4HQE6Dn6F6))
Feb 24, 2025 10:43:36 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postConstruct
INFO: Authorization Endpoint Controller created.
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postAuthorization
INFO: AuthorizationEndpoint::Authorization:Received /authorization?response_type=code&client_id=b0c46635-c0b4-448c-a8b9-9bd282d2e05a&redirect_uri=http://localhost:3000/login&scope=launch/patient openid fhirUser offline_access patient/*.read&state=98wrghuwuogerg97&aud=http://localhost:8080/fhir
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
INFO: Database::read(Users b0c46635-c0b4-448c-a8b9-9bd282d2e05a)
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read query: prep235: SELECT TOP 1 id, secret, redirect, timestamp FROM Clients WHERE id = ? ORDER BY timestamp DESC {1: 'b0c46635-c0b4-448c-a8b9-9bd282d2e05a'}
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read: b0c46635-c0b4-448c-a8b9-9bd282d2e05a/bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::handleAuthorizationPost:Received login request from Patient1
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
INFO: Database::read(Users, {username=Patient1})
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read query: prep236: SELECT TOP 1 patient_id, username, password, timestamp, refresh_token FROM Users WHERE username = ? ORDER BY timestamp DESC {1: 'Patient1'}
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read: Patient1/Patient1
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::User Patient1 is authorized
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::Generated code eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE0OSwiaWF0IjoxNzQwNDU1MDI5LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.GYzzEJDmgtsdaxMo7QyY1doFmqBW5fVP964p9nYRJFhaqS7T9a4LwhSq5LRvctNEq3DzPduxMiTCC9zMBINQSg
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: Redirecting to http://localhost:3000/login?code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE0OSwiaWF0IjoxNzQwNDU1MDI5LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.GYzzEJDmgtsdaxMo7QyY1doFmqBW5fVP964p9nYRJFhaqS7T9a4LwhSq5LRvctNEq3DzPduxMiTCC9zMBINQSg&state=98wrghuwuogerg97
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postAccessToken
INFO: TokenEndpoint::Token:Received request /token?grant_type=authorization_code&code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE0OSwiaWF0IjoxNzQwNDU1MDI5LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.GYzzEJDmgtsdaxMo7QyY1doFmqBW5fVP964p9nYRJFhaqS7T9a4LwhSq5LRvctNEq3DzPduxMiTCC9zMBINQSg&redirect_uri=http://localhost:3000/login
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
FINE: TokenEndpoint::AuthHeader:Basic YjBjNDY2MzUtYzBiNC00NDhjLWE4YjktOWJkMjgyZDJlMDVhOmJVWWJFajV3cGF6UzhYdjFqeXJ1RktwdVhhMjRPR245TUh1WjN5Z0tleGFJNW1oS1VJelZFQnZidjJ1Z2dWZjFjVzZrWUQzY2dUYkNJR0sza2ppTWNtSnEzT0c5Ym44NUZoMng3SktZZ3k3SndhZ2R6czBxdWZna2hQR0R2RW9WcEltcEE0Y2xJaGZ3bjU4cW9UcmZIeDg2b29XTFdKZVFoNHMwU3RFTXFveExxYm95d3I4dTExcW1NSGQxeHdCTGVoR1hVYnFwRUJsa2VsQkhEV2FpQ2praHdaZVJlNG5WdTRvOHdTQWJQUUlFQ1FjVGpxWUJVckJqSGxNeDV2WFU=
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
FINE: TokenEndpoint::client:b0c46635-c0b4-448c-a8b9-9bd282d2e05a(bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU)
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
INFO: Database::read(Users b0c46635-c0b4-448c-a8b9-9bd282d2e05a)
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read query: prep237: SELECT TOP 1 id, secret, redirect, timestamp FROM Clients WHERE id = ? ORDER BY timestamp DESC {1: 'b0c46635-c0b4-448c-a8b9-9bd282d2e05a'}
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read: b0c46635-c0b4-448c-a8b9-9bd282d2e05a/bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
INFO: TokenEndpoint::clientIsAuthorized:b0c46635-c0b4-448c-a8b9-9bd282d2e05a
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
INFO: Database::read(Users, {username=Patient1})
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read query: prep238: SELECT TOP 1 patient_id, username, password, timestamp, refresh_token FROM Users WHERE username = ? ORDER BY timestamp DESC {1: 'Patient1'}
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read: Patient1/Patient1
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.TokenEndpoint handleTokenRequest
FINE: TokenEndpoint::Token:Patient:Patient1
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.TokenEndpoint handleTokenRequest
FINE: TokenEndpoint::Token:Generated token eyJraWQiOiJOalZCUmpZNU1EbENNVUl3TnpVNFJUQTJRelpGTURRNFF6UTJNREF5UWpWRE5qazFSVE0yUWciLCJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1ODYyOSwiaWF0IjoxNzQwNDU1MDI5LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInBhdGllbnRfaWQiOiJQYXRpZW50MSIsImp0aSI6ImYxMDEyMTBiLTkzMmEtNDdhNy05NjU3LTk5MzZlOWUxNDA2MCJ9.KkgVvajw7jzZan6vd2GzZoozRrwQG1wXS8IfQsrL49aJN_K1DFh1Qtiv6lZS-ckAVJesqBbJstwuHYHvJNFhvQ
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database update
INFO: Database::update(Users WHERE {patient_id=Patient1}, SET{refresh_token=58016bd4-6f38-4ef2-a81e-26fbf2eec475})
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.authorization.Database update
FINE: prep239: UPDATE Users SET refresh_token = ?, timestamp = CURRENT_TIMESTAMP WHERE patient_id = ? {1: '58016bd4-6f38-4ef2-a81e-26fbf2eec475', 2: 'Patient1'}
Feb 24, 2025 10:43:49 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:43:59 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController getAuthorization
INFO: AuthorizationEndpoint::Authorization:Received /authorization?response_type=code&client_id=b0c46635-c0b4-448c-a8b9-9bd282d2e05a&redirect_uri=http://localhost:3000/login&scope=launch/patient openid fhirUser offline_access patient/*.read&state=98wrghuwuogerg97&aud=http://localhost:8080/fhir
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postAuthorization
INFO: AuthorizationEndpoint::Authorization:Received /authorization?response_type=code&client_id=b0c46635-c0b4-448c-a8b9-9bd282d2e05a&redirect_uri=http://localhost:3000/login&scope=launch/patient openid fhirUser offline_access patient/*.read&state=98wrghuwuogerg97&aud=http://localhost:8080/fhir
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
INFO: Database::read(Users b0c46635-c0b4-448c-a8b9-9bd282d2e05a)
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read query: prep248: SELECT TOP 1 id, secret, redirect, timestamp FROM Clients WHERE id = ? ORDER BY timestamp DESC {1: 'b0c46635-c0b4-448c-a8b9-9bd282d2e05a'}
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read: b0c46635-c0b4-448c-a8b9-9bd282d2e05a/bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::handleAuthorizationPost:Received login request from Patient1
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
INFO: Database::read(Users, {username=Patient1})
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read query: prep249: SELECT TOP 1 patient_id, username, password, timestamp, refresh_token FROM Users WHERE username = ? ORDER BY timestamp DESC {1: 'Patient1'}
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read: Patient1/Patient1
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::User Patient1 is authorized
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::Generated code eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE2NywiaWF0IjoxNzQwNDU1MDQ3LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.M6V9HkT8USVUz56yzgkUICupj22LXGLlWTq774_-31L_XrSN5jZe9KFci3ZMiXLK159fsjcGkqguNG_t48a7-A
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: Redirecting to http://localhost:3000/login?code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE2NywiaWF0IjoxNzQwNDU1MDQ3LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.M6V9HkT8USVUz56yzgkUICupj22LXGLlWTq774_-31L_XrSN5jZe9KFci3ZMiXLK159fsjcGkqguNG_t48a7-A&state=98wrghuwuogerg97
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postAccessToken
INFO: TokenEndpoint::Token:Received request /token?grant_type=authorization_code&code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTE2NywiaWF0IjoxNzQwNDU1MDQ3LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.M6V9HkT8USVUz56yzgkUICupj22LXGLlWTq774_-31L_XrSN5jZe9KFci3ZMiXLK159fsjcGkqguNG_t48a7-A&redirect_uri=http://localhost:3000/login
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
FINE: TokenEndpoint::AuthHeader:Basic YjBjNDY2MzUtYzBiNC00NDhjLWE4YjktOWJkMjgyZDJlMDVhOmJVWWJFajV3cGF6UzhYdjFqeXJ1RktwdVhhMjRPR245TUh1WjN5Z0tleGFJNW1oS1VJelZFQnZidjJ1Z2dWZjFjVzZrWUQzY2dUYkNJR0sza2ppTWNtSnEzT0c5Ym44NUZoMng3SktZZ3k3SndhZ2R6czBxdWZna2hQR0R2RW9WcEltcEE0Y2xJaGZ3bjU4cW9UcmZIeDg2b29XTFdKZVFoNHMwU3RFTXFveExxYm95d3I4dTExcW1NSGQxeHdCTGVoR1hVYnFwRUJsa2VsQkhEV2FpQ2praHdaZVJlNG5WdTRvOHdTQWJQUUlFQ1FjVGpxWUJVckJqSGxNeDV2WFU=
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
FINE: TokenEndpoint::client:b0c46635-c0b4-448c-a8b9-9bd282d2e05a(bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU)
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
INFO: Database::read(Users b0c46635-c0b4-448c-a8b9-9bd282d2e05a)
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read query: prep250: SELECT TOP 1 id, secret, redirect, timestamp FROM Clients WHERE id = ? ORDER BY timestamp DESC {1: 'b0c46635-c0b4-448c-a8b9-9bd282d2e05a'}
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read: b0c46635-c0b4-448c-a8b9-9bd282d2e05a/bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.AuthUtils clientIsAuthorized
INFO: TokenEndpoint::clientIsAuthorized:b0c46635-c0b4-448c-a8b9-9bd282d2e05a
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
INFO: Database::read(Users, {username=Patient1})
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read query: prep251: SELECT TOP 1 patient_id, username, password, timestamp, refresh_token FROM Users WHERE username = ? ORDER BY timestamp DESC {1: 'Patient1'}
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read: Patient1/Patient1
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.TokenEndpoint handleTokenRequest
FINE: TokenEndpoint::Token:Patient:Patient1
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.TokenEndpoint handleTokenRequest
FINE: TokenEndpoint::Token:Generated token eyJraWQiOiJOalZCUmpZNU1EbENNVUl3TnpVNFJUQTJRelpGTURRNFF6UTJNREF5UWpWRE5qazFSVE0yUWciLCJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1ODY0NywiaWF0IjoxNzQwNDU1MDQ3LCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInBhdGllbnRfaWQiOiJQYXRpZW50MSIsImp0aSI6IjBjMDQ2OTY3LWViNDEtNGY5Mi1hMTM3LTI5YzQzMDU5ZWRkOSJ9.SqoWbrr1yTiCH4_XCJ9Lj6y0pMEmx-c1dCeK-Ax9QqT4c34OazAt-axN-HAyaH7opaOq7VI7QcKuHvZBvPeEfg
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database update
INFO: Database::update(Users WHERE {patient_id=Patient1}, SET{refresh_token=e4d7f955-77bc-4329-9aa6-5435cd04b326})
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.authorization.Database update
FINE: prep252: UPDATE Users SET refresh_token = ?, timestamp = CURRENT_TIMESTAMP WHERE patient_id = ? {1: 'e4d7f955-77bc-4329-9aa6-5435cd04b326', 2: 'Patient1'}
Feb 24, 2025 10:44:07 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:45:27 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController getAuthorization
INFO: AuthorizationEndpoint::Authorization:Received /authorization?response_type=code&client_id=b0c46635-c0b4-448c-a8b9-9bd282d2e05a&redirect_uri=http://localhost:3000/login&scope=launch/patient openid fhirUser offline_access patient/*.read&state=98wrghuwuogerg97&aud=http://localhost:8080/fhir
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.OauthEndpointController postAuthorization
INFO: AuthorizationEndpoint::Authorization:Received /authorization?response_type=code&client_id=b0c46635-c0b4-448c-a8b9-9bd282d2e05a&redirect_uri=http://localhost:3000/login&scope=launch/patient openid fhirUser offline_access patient/*.read&state=98wrghuwuogerg97&aud=http://localhost:8080/fhir
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
INFO: Database::read(Users b0c46635-c0b4-448c-a8b9-9bd282d2e05a)
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read query: prep306: SELECT TOP 1 id, secret, redirect, timestamp FROM Clients WHERE id = ? ORDER BY timestamp DESC {1: 'b0c46635-c0b4-448c-a8b9-9bd282d2e05a'}
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readClient
FINE: read: b0c46635-c0b4-448c-a8b9-9bd282d2e05a/bUYbEj5wpazS8Xv1jyruFKpuXa24OGn9MHuZ3ygKexaI5mhKUIzVEBvbv2uggVf1cW6kYD3cgTbCIGK3kjiMcmJq3OG9bn85Fh2x7JKYgy7Jwagdzs0qufgkhPGDvEoVpImpA4clIhfwn58qoTrfHx86ooWLWJeQh4s0StEMqoxLqboywr8u11qmMHd1xwBLehGXUbqpEBlkelBHDWaiCjkhwZeRe4nVu4o8wSAbPQIECQcTjqYBUrBjHlMx5vXU
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::handleAuthorizationPost:Received login request from Patient1
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
INFO: Database::read(Users, {username=Patient1})
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read query: prep307: SELECT TOP 1 patient_id, username, password, timestamp, refresh_token FROM Users WHERE username = ? ORDER BY timestamp DESC {1: 'Patient1'}
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.Database readUser
FINE: read: Patient1/Patient1
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::User Patient1 is authorized
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: AuthorizationEndpoint::Generated code eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTI1MywiaWF0IjoxNzQwNDU1MTMzLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.FD9CET-5WmF5eI1u-tzolgF1-RPMfcl2lh8Sr_qcRye5FeSoAvLpWlG7h3RYhVSj86eqvTd30LMl2Z6Jhf8Nzw
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.authorization.AuthorizationEndpoint handleAuthorizationPost
INFO: Redirecting to http://localhost:3000/login?code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImV4cCI6MTc0MDQ1NTI1MywiaWF0IjoxNzQwNDU1MTMzLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZmhpciIsImNsaWVudF9pZCI6ImIwYzQ2NjM1LWMwYjQtNDQ4Yy1hOGI5LTliZDI4MmQyZTA1YSIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbiIsInVzZXJuYW1lIjoiUGF0aWVudDEifQ.FD9CET-5WmF5eI1u-tzolgF1-RPMfcl2lh8Sr_qcRye5FeSoAvLpWlG7h3RYhVSj86eqvTd30LMl2Z6Jhf8Nzw&state=98wrghuwuogerg97
Feb 24, 2025 10:45:33 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:46:13 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:46:13 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor buildRuleList
SEVERE: Authorization failed
com.auth0.jwt.exceptions.JWTDecodeException: The token was expected to have 3 parts, but got 0.
	at com.auth0.jwt.TokenUtils.wrongNumberOfParts(TokenUtils.java:45)
	at com.auth0.jwt.TokenUtils.splitToken(TokenUtils.java:23)
	at com.auth0.jwt.JWTDecoder.<init>(JWTDecoder.java:37)
	at com.auth0.jwt.JWTVerifier.verify(JWTVerifier.java:451)
	at ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor.verify(PatientAuthorizationInterceptor.java:108)
	at ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor.buildRuleList(PatientAuthorizationInterceptor.java:50)
	at ca.uhn.fhir.rest.server.interceptor.auth.AuthorizationInterceptor.applyRulesAndReturnDecision(AuthorizationInterceptor.java:157)
	at ca.uhn.fhir.rest.server.interceptor.auth.AuthorizationInterceptor.applyRulesAndFailIfDeny(AuthorizationInterceptor.java:135)
	at ca.uhn.fhir.rest.server.interceptor.auth.AuthorizationInterceptor.incomingRequestPreHandled(AuthorizationInterceptor.java:420)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService$HookInvoker.invokeMethod(BaseInterceptorService.java:630)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService$HookInvoker.invoke(BaseInterceptorService.java:600)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService.callInvokers(BaseInterceptorService.java:431)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService.doCallHooks(BaseInterceptorService.java:298)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService.callHooks(BaseInterceptorService.java:291)
	at ca.uhn.fhir.interceptor.executor.BaseInterceptorService.callHooks(BaseInterceptorService.java:68)
	at ca.uhn.fhir.rest.server.method.PageMethodBinding.callPreHandledHooks(PageMethodBinding.java:177)
	at ca.uhn.fhir.rest.server.method.BaseMethodBinding.invokeServerMethod(BaseMethodBinding.java:258)
	at ca.uhn.fhir.rest.server.method.SearchMethodBinding.invokeServer(SearchMethodBinding.java:311)
	at ca.uhn.fhir.rest.server.method.SearchMethodBinding.invokeServer(SearchMethodBinding.java:53)
	at ca.uhn.fhir.rest.server.method.BaseResourceReturningMethodBinding.doInvokeServer(BaseResourceReturningMethodBinding.java:146)
	at ca.uhn.fhir.rest.server.method.BaseResourceReturningMethodBinding.invokeServer(BaseResourceReturningMethodBinding.java:275)
	at ca.uhn.fhir.rest.server.RestfulServer.handleRequest(RestfulServer.java:1201)
	at ca.uhn.fhir.rest.server.RestfulServer.doGet(RestfulServer.java:424)
	at ca.uhn.fhir.rest.server.RestfulServer.service(RestfulServer.java:1955)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:614)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)

Feb 24, 2025 10:46:35 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:46:43 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
Feb 24, 2025 10:46:54 PM ca.uhn.fhir.jpa.starter.PatientAuthorizationInterceptor verify
FINE: Verifying JWT token ISS and AUD is http://localhost:8080/fhir
